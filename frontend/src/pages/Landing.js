import { useState } from 'react';
import { BrowserRouter as Router,
    Routes,
    Route,
    Link } from "react-router-dom";
import { BlocksRenderer } from '@strapi/blocks-react-renderer';

/* === COMPONENTS === */
import useFetch from "../useFetch";
import RichText from '../components/RichText';
import Image from '../components/Image';
import FeaturedProject from '../components/FeaturedProject';

    function Landing() {

        const { isLoading, error, data } = useFetch(`${process.env.REACT_APP_BACKEND}/api/landing-page?pLevel`)

        let mission = null;
        let sections = null;
        let display = [];

        if (data) {

            sections = data.data.Sections
            mission = data.data.Mission

            console.log(data)
            
            for (let i = 0; i < sections.length; i ++) {
                if (sections[i].__component === "media.values") {
                    display.push(<RichText data={sections[i]} />)
                }
                
                if (sections[i].__component === "media.image") {
                    display.push(<Image data={sections[i]} />)
                }

                if (sections[i].__component === "media.featured-project") {
                    display.push(<FeaturedProject data={sections[i]} />)
                }
            }

            return (
                <div className="page-wrapper flex column ai-flex-end min-section-height">
                    <div className="section-wrapper flex column jc-center ai-flex-center relative">
                        <svg width="1045" height="379" viewBox="0 0 1045 379" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_231_3158)">
                            <path d="M61.5391 139.088C53.4587 139.088 48.7669 135.974 46.9423 128.968C45.639 124.037 43.5537 121.442 38.8619 121.442H7.84365C2.89115 121.442 -0.23674 124.297 0.0239172 129.487C2.63049 163.999 22.1798 183.201 61.5391 183.201H99.4056V139.088H61.5391ZM111.846 0H62.8424C18.7913 0 1.06655 21.0189 1.06655 56.3098C1.06655 91.6007 16.706 105.613 56.5866 108.727L99.4056 111.935V82.8252H155.163C146.632 78.0363 135.282 75.2527 120.708 74.2147L61.7998 69.8034C51.1128 69.0249 46.9423 65.911 46.9423 56.5693C46.9423 47.2276 51.8948 44.1137 63.3637 44.1137H111.846C119.926 44.1137 124.618 47.2276 126.443 54.2338C127.746 59.1642 129.831 61.7591 134.523 61.7591H165.541C170.494 61.7591 173.622 58.9047 173.361 53.7149C170.755 19.2024 151.205 0 111.846 0Z" fill="black"/>
                            <path d="M341.012 0H194.783C189.83 0 186.963 2.85441 186.963 7.78476V36.5884C186.963 41.5187 189.83 44.3731 194.783 44.3731H244.568V82.8252H291.226V44.3731H341.012C345.964 44.3731 348.831 41.5187 348.831 36.5884V7.78476C348.831 2.85441 345.964 0 341.012 0Z" fill="black"/>
                            <path d="M403.901 0H373.143C368.19 0 365.323 2.85441 365.323 7.78476V82.8252H411.72V7.78476C411.72 2.85441 408.853 0 403.901 0ZM541.788 0H511.031C506.078 0 503.211 2.85441 503.211 7.78476V82.8252H549.608V7.78476C549.608 2.85441 546.741 0 541.788 0Z" fill="black"/>
                            <path d="M697.188 0H585.887C580.935 0 578.067 2.85441 578.067 7.78476V82.8252H624.464V44.1137H691.453C703.965 44.1137 712.827 46.9681 712.827 69.0249V82.8252H758.703V68.7654C758.703 24.3923 738.632 0 697.188 0Z" fill="black"/>
                            <path d="M821.048 0H790.551C785.599 0 782.731 2.85441 782.731 7.78476V82.8252H828.868V7.78476C828.868 2.85441 826.001 0 821.048 0Z" fill="black"/>
                            <path d="M983.224 0H914.671C872.966 0 852.896 25.9492 852.896 63.3161V82.8252H899.293V61.7591C899.293 45.9301 904.766 44.1137 914.671 44.1137H983.224C993.129 44.1137 998.603 45.9301 998.603 61.7591V121.702C998.603 137.271 992.347 139.088 983.224 139.088H945.619V183.201H983.224C1024.93 183.201 1045 157.252 1045 120.145V63.3161C1045 25.9492 1024.93 0 983.224 0Z" fill="black"/>
                            <path d="M173.716 296.175H99.4053V293.627H46.4207V239.912H99.4053V195.799H7.84342C2.89093 195.799 0 198.653 0 203.583V371.215C0 376.146 2.86723 379 7.81973 379H38.5773C43.5298 379 46.397 376.146 46.397 371.215V337.222H96.4433L119.381 373.81C121.466 377.443 124.594 379 128.765 379H163.954C170.209 379 172.555 375.108 168.906 369.658L142.58 332.032C159.12 325.38 169.001 312.83 173.693 296.175H173.716Z" fill="black"/>
                            <path d="M401.058 369.918L367.338 296.175H319.211L326.249 313.089H267.862L274.899 296.175H226.512L192.792 369.918C190.446 375.367 192.792 379 198.787 379H233.715C238.147 379 241.275 376.924 242.839 373.032L252.222 350.456H341.628L351.011 373.032C352.575 376.924 355.703 379 360.134 379H395.063C401.058 379 403.404 375.367 401.058 369.918Z" fill="black"/>
                            <path d="M600.413 296.175L594.039 318.798L588.21 296.175H548.424L568.234 372.253C569.277 376.665 572.404 379 577.096 379H610.721C615.152 379 618.28 376.924 619.583 372.513L644.701 296.175H600.413ZM489.847 296.175L484.018 318.798L477.644 296.175H433.355L458.497 372.513C459.777 376.924 462.928 379 467.336 379H500.984C505.676 379 508.804 376.665 509.847 372.253L529.657 296.175H489.847Z" fill="black"/>
                            <path d="M846.071 334.886H750.931V296.175H704.534V371.215C704.534 376.146 707.401 379 712.354 379H846.071C851.024 379 853.891 376.146 853.891 371.215V342.671C853.891 337.741 851.024 334.886 846.071 334.886Z" fill="black"/>
                            <path d="M989.48 270.013L945.618 266.734V296.175H891.212C899.695 300.751 910.951 303.393 925.358 304.526L984.267 308.937C994.954 309.716 999.124 312.829 999.124 322.431C999.124 332.032 994.172 334.886 982.703 334.886H930.311C922.23 334.886 917.538 331.772 915.714 324.766C914.41 319.836 912.325 317.241 907.633 317.241H876.615C871.663 317.241 868.535 320.095 868.795 325.285C871.402 359.798 890.951 379 930.311 379H983.224C1027.28 379 1045 357.981 1045 322.69C1045 287.399 1029.1 272.868 989.48 270.013ZM980.617 195.799H945.618V239.912H980.617C988.698 239.912 993.39 243.026 995.214 250.032C996.518 254.963 998.603 257.558 1003.29 257.558H1034.31C1039.27 257.558 1042.39 254.703 1042.13 249.513C1039.53 215.001 1019.98 195.799 980.617 195.799Z" fill="black"/>
                            </g>
                            <defs>
                            <clipPath id="clip0_231_3158">
                            <rect width="1045" height="379" fill="white"/>
                            </clipPath>
                            </defs>
                        </svg>
                        <div className="absolute width-50">
                            <BlocksRenderer 
                                content={ mission } 
                                blocks={{
                                    paragraph: ({ children }) => <p className="no-margin-top">{ children }</p>,
                                    heading: ({ children, level }) => {
                                    switch (level) {
                                        case 1:
                                            return <h1 style={{ margin: '0px' }}>{ children }</h1>
                                        case 2:
                                            return <h2 style={{ margin: '0px' }}>{ children }</h2>
                                    }
                                    },
                                }}
                            />
                        </div>
                    </div>
                    {display.map((section, index) => 
                        <div key={ index }>
                            { section }
                        </div>
                    )}
                </div>
            );
        }
    }
    
    export default Landing;